<?xml version="1.0" encoding="utf-8"?>
<EditLinkWindow 
	xmlns:mx="http://www.adobe.com/2006/mxml" 
	xmlns="de.waveumleditor.view.diagrammer.dialogues.*">
	
	<mx:Script>
		<![CDATA[
			import de.waveumleditor.view.diagrammer.classDiagram.ClassLink;
			import de.waveumleditor.view.diagrammer.classDiagram.AssociationLink;
			import de.waveumleditor.model.classDiagram.link.LinkAssociation;
			import de.waveumleditor.view.diagrammer.events.LinkEditEvent;
			
			import mx.events.CloseEvent;
			import mx.managers.PopUpManager;
			import mx.managers.SystemManager;
			
			import mx.core.Application;
			
			private var viewLink:ClassLink = null;
			private var link:LinkAssociation = null;
			
			private function close():void {
				PopUpManager.removePopUp(titleWindow);
			}
			
			public function setViewLink(link:ClassLink):void
			{
				this.viewLink = link;
			}
			
			public function popUp():void
			{	
				titleWindow.title = "Link editieren";
				titleWindow.addChild(editLinkCanvas);
				
				PopUpManager.addPopUp(titleWindow, SystemManager.getSWFRoot(titleWindow), true);
				PopUpManager.centerPopUp(titleWindow);
			}
			
			private function handleLinkDescription():void
			{
				this.viewLink.linkName = txLinkName.text;
				this.viewLink.linkAttributeFrom = txLinkAttrFrom.text;
				this.viewLink.linkMultiplicityFrom = txLinkMultiplicityFrom.text;
				this.viewLink.linkAttributeTo = txLinkAttrTo.text;
				this.viewLink.linkMultiplicityTo = txLinkMultiplicityTo.text;
				this.viewLink.linkNavigableTo = checkboxNaviTo.selected;
				this.viewLink.linkNavigableFrom = checkboxNaviFrom.selected;
			}
			
			public function update(link:LinkAssociation):void 
			{
				this.link = link;
				
				txLinkName.text = link.getName();
				txLinkAttrFrom.text = link.getFromName();
				txLinkMultiplicityFrom.text = link.getFromMultiplicity();
				txLinkAttrTo.text = link.getToName();
				txLinkMultiplicityTo.text = link.getToMultiplicity();
				checkboxNaviTo.selected = link.getToNavigable();
				checkboxNaviFrom.selected = link.getFromNavigable();
				
				//get Assoziation Type	
			}
			
			private function save():void
			{
				var event:LinkEditEvent = new LinkEditEvent(link);
				link.setName(txLinkName.text);
				link.setFromName(txLinkAttrFrom.text);
				link.setFromMultiplicity(txLinkMultiplicityFrom.text);
				link.setToName(txLinkAttrTo.text);
				link.setToMultiplicity(txLinkMultiplicityTo.text);
				link.setToNavigable(checkboxNaviTo.selected);
				link.setFromNavigable(checkboxNaviFrom.selected);
				
				// todo: eigenschaften setzen
				// set Komposition ... Aggregation Type 
				
				getController().handleSaveLink(event);				
				close();
			}
			
		]]>
	</mx:Script>
	<!--	<container> -->
	<mx:TitleWindow xmlns:mx="http://www.adobe.com/2006/mxml" 
					id="titleWindow"
					layout="vertical"
					minWidth="240" 
					minHeight="100"
					title="Link editieren"
					titleStyleName="titleText"
					backgroundColor="#FFFFFF"
					backgroundAlpha="0.7"
					borderAlpha="1.0"
					cornerRadius="10"
					dropShadowEnabled="true"
					showCloseButton="true"
					close="close()" borderColor="#E2E2E2" width="697" height="287" x="10" y="10"> 
		
		<mx:Canvas id="editLinkCanvas" width="667" height="237">
		<mx:Image source="de/waveumleditor/view/diagrammer/assets/images/Background_LinkDescription.png" width="651" height="173" scaleContent="true" x="10" y="10" alpha="0.5"/>
			<mx:Canvas backgroundAlpha="1.0" top="0" right="0" left="0" bottom="63">
				<mx:TextInput id="txLinkName" tabIndex="1" x="276.5" y="54" text="" editable="true" width="120" textAlign="center"/>
				<mx:TextInput id="txLinkAttrTo" tabIndex="5" x="404.5" y="100" text="" editable="true" width="115" textAlign="right"/>
				<mx:TextInput id="txLinkMultiplicityFrom" tabIndex="2" x="153.5" y="54" text="" editable="true" width="61"/>
				<mx:TextInput id="txLinkMultiplicityTo" tabIndex="3" x="458.5" y="54" editable="true" width="61" textAlign="right"/>
				<mx:TextInput id="txLinkAttrFrom" tabIndex="4" x="153.5" y="100" text="" editable="true" width="115"/>
				<mx:CheckBox id="checkboxNaviFrom" tabIndex="6" x="153.5" y="146" label="NavigableFrom" enabled="true"/>
				<mx:CheckBox id="checkboxNaviTo" tabIndex="7" x="426.5" y="146" label="NavigableTo" enabled="true"/>
				
				<mx:Label x="153.5" y="39" text="Multiplicity" width="71"/>
				<mx:Label x="447.5" y="39" text="Multiplicity" width="72" textAlign="right"/>
				<mx:Label x="153.5" y="120" text="Attribute" width="115"/>
				<mx:Label x="404.5" y="120" text="Attribute" width="115" textAlign="right"/>
				<mx:Label x="276.5" y="39" text="Name" width="120" textAlign="center"/>
			</mx:Canvas>
			<mx:Button label="Speichern" tabIndex="8" click="save(); handleLinkDescription()" x="483" y="211"/>
			<mx:Button label="Abbrechen" tabIndex="9" click="close()" x="573" y="211"/>
		</mx:Canvas>
	</mx:TitleWindow> 
	<!--	</container>-->

</EditLinkWindow>
